{"version":3,"file":"npm-to-yarn.js","sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["export var unchangedCLICommands = [\n  'init',\n  'run',\n  'test',\n  'login',\n  'logout',\n  'link',\n  'publish',\n  'cache'\n]\n\nexport var yarnCLICommands = [\n  'add',\n  'audit',\n  'autoclean',\n  'bin',\n  'check',\n  'config',\n  'create',\n  'dedupe',\n  'generate-lock-entry',\n  'global',\n  'help',\n  'import',\n  'info',\n  'install',\n  'licenses',\n  'list',\n  'lockfile',\n  'outdated',\n  'owner',\n  'pack',\n  'policies',\n  'prune',\n  'remove',\n  'self-update',\n  'tag',\n  'team',\n  'unlink',\n  'upgrade',\n  'upgrade-interactive',\n  'version',\n  'versions',\n  'why',\n  'workspace',\n  'workspaces'\n]\n\nexport var uniqueYarnCLICommands = [\n  'add',\n  'autoclean',\n  'check',\n  'create',\n  'generate-lock-entry',\n  'global',\n  'import',\n  'info',\n  'licenses',\n  'link',\n  'list',\n  'lockfile',\n  'policies',\n  'remove',\n  'run',\n  'self-update',\n  'tag',\n  'unlink',\n  'upgrade',\n  'upgrade-interactive',\n  'versions',\n  'why',\n  'workspace',\n  'workspaces'\n]\n\nexport var npmCLICommands = [\n  'access',\n  'adduser',\n  'audit',\n  'bin',\n  'bugs',\n  'build',\n  'bundle',\n  'ci',\n  'completion',\n  'config',\n  'dedupe',\n  'deprecate',\n  'dist-tag',\n  'docs',\n  'doctor',\n  'edit',\n  'explore',\n  'fund',\n  'help-search',\n  'help',\n  'hook',\n  'install-ci-test',\n  'install-test',\n  'install',\n  'ls',\n  'npm',\n  'org',\n  'outdated',\n  'owner',\n  'pack',\n  'ping',\n  'prefix',\n  'profile',\n  'prune',\n  'rebuild',\n  'repo',\n  'restart',\n  'root',\n  'run-script',\n  'search',\n  'shrinkwrap',\n  'star',\n  'stars',\n  'start',\n  'stop',\n  'team',\n  'token',\n  'uninstall',\n  'unpublish',\n  'update',\n  'version',\n  'view',\n  'whoami'\n]\n","import {\n  unchangedCLICommands,\n  yarnCLICommands,\n  uniqueYarnCLICommands,\n  npmCLICommands\n} from './utils'\n\n// keys are NPM, vals are Yarn\n\ninterface Indexable {\n  [index: string]: string | Function\n}\n\nvar npmToYarnTable: Indexable = {\n  install: function (command: string) {\n    if (/^install *$/.test(command)) {\n      return 'install'\n    }\n    var ret = command\n      .replace('install', 'add')\n      .replace('--save-dev', '--dev')\n      .replace(/\\s*--save/, '')\n      .replace('--no-package-lock', '--no-lockfile')\n      .replace('--save-optional', '--optional')\n      .replace('--save-exact', '--exact')\n    if (/ -(?:-global|g)(?![^\\b])/.test(ret)) {\n      ret = ret.replace(/ -(?:-global|g)(?![^\\b])/, '')\n      ret = 'global ' + ret\n    }\n    return ret\n  },\n  uninstall: function (command: string) {\n    var ret = command\n      .replace('uninstall', 'remove')\n      .replace('--save-dev', '--dev')\n      .replace(/\\s*--save/, '')\n      .replace('--no-package-lock', '--no-lockfile')\n    if (/ -(?:-global|g)(?![^\\b])/.test(ret)) {\n      ret = ret.replace(/ -(?:-global|g)(?![^\\b])/, '')\n      ret = 'global ' + ret\n    }\n    return ret\n  },\n  version: function (command: string) {\n    return command.replace(/(major|minor|patch)/, '--$1')\n  },\n  rebuild: function (command: string) {\n    return command.replace('rebuild', 'add --force')\n  }\n}\n\nvar yarnToNpmTable: Indexable = {\n  add: function (command: string, global?: true) {\n    var dev\n    if (command === 'add --force') {\n      return 'rebuild'\n    }\n    var ret = command\n      .replace('add', 'install')\n      .replace(/\\s*--dev/, function () {\n        dev = true\n        return ''\n      })\n      .replace('--no-lockfile', '--no-package-lock')\n      .replace('--optional', '--save-optional')\n      .replace('--exact', '--save-exact')\n    if (dev) {\n      ret += ' --save-dev'\n    } else if (global) {\n      ret += ' --global'\n    } else {\n      ret += ' --save'\n    }\n    return ret\n  },\n  remove: function (command: string, global?: true) {\n    var dev\n    var ret = command\n      .replace('remove', 'uninstall')\n      .replace(/\\s*--dev/, function () {\n        dev = true\n        return ''\n      })\n      .replace('--no-lockfile', '--no-package-lock')\n      .replace('--optional', '--save-optional')\n      .replace('--exact', '--save-exact')\n    if (dev) {\n      ret += ' --save-dev'\n    } else if (global) {\n      ret += ' --global'\n    } else {\n      ret += ' --save'\n    }\n    return ret\n  },\n  version: function (command: string) {\n    return command.replace(/--(major|minor|patch)/, '$1')\n  },\n  install: 'install'\n}\n\nyarnToNpmTable.global = function (command: string) {\n  if (/^global add/.test(command)) {\n    return (yarnToNpmTable.add as Function)(command.replace(/^global add/, 'add'), true)\n  } else if (/^global remove/.test(command)) {\n    return (yarnToNpmTable.remove as Function)(command.replace(/^global remove/, 'remove'), true)\n  }\n}\n\nexport default function convert (str: string, to: 'npm' | 'yarn'): string {\n  var returnStr = str\n  if (to === 'npm') {\n    return returnStr.replace(/yarn(?: +([^&\\n\\r]*))?/gm, yarnToNPM)\n  } else {\n    return returnStr.replace(/npm(?: +([^&\\n\\r]*))?/gm, npmToYarn)\n  }\n}\n\nfunction npmToYarn (m: string, command: string): string {\n  command = (command || '').trim()\n  var firstCommand = (/\\w+/.exec(command) || [''])[0]\n\n  if (unchangedCLICommands.includes(firstCommand)) {\n    return 'yarn ' + command\n  } else if (\n    Object.prototype.hasOwnProperty.call(npmToYarnTable, firstCommand) &&\n    npmToYarnTable[firstCommand]\n  ) {\n    if (typeof npmToYarnTable[firstCommand] === 'function') {\n      return 'yarn ' + (npmToYarnTable[firstCommand] as Function)(command)\n    } else {\n      return 'yarn ' + command.replace(firstCommand, npmToYarnTable[firstCommand] as string)\n    }\n  } else {\n    return 'yarn ' + command + \"\\n# couldn't auto-convert command\"\n  }\n}\n\nfunction yarnToNPM (m: string, command: string): string {\n  command = (command || '').trim()\n  if (command === '') {\n    return 'npm install'\n  }\n  var firstCommand = (/\\w+/.exec(command) || [''])[0]\n\n  if (unchangedCLICommands.includes(firstCommand)) {\n    return 'npm ' + command\n  } else if (\n    Object.prototype.hasOwnProperty.call(yarnToNpmTable, firstCommand) &&\n    yarnToNpmTable[firstCommand]\n  ) {\n    if (typeof yarnToNpmTable[firstCommand] === 'function') {\n      return 'npm ' + (yarnToNpmTable[firstCommand] as Function)(command)\n    } else {\n      return 'npm ' + command.replace(firstCommand, yarnToNpmTable[firstCommand] as string)\n    }\n  } else if (!yarnCLICommands.includes(firstCommand)) {\n    // i.e., yarn grunt -> npm run grunt\n    return 'npm run ' + command\n  } else {\n    return 'npm ' + command + \"\\n# couldn't auto-convert command\"\n  }\n}\n"],"names":[],"mappings":"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"}